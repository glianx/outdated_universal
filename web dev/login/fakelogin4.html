<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title></title>


    <!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">

            
</head>
<body>

	<nav>
		<div class="nav-wrapper">
			<a href="#" class="brand-logo center">History of Chemistry</a>
				<ul id="nav-mobile" class="left hide-on-med-and-down">
					<li><a href="#login_modal" id = "login_nav" class = "modal-trigger">Login</a></li>
					<li><a href="#new_user_modal" id = "newuser_nav" class = "modal-trigger">New User</a></li>
					<li><a href="#" id = "logout_nav" style = "display:none">Logout</a></li>
					<li><a href="#" id = "game_nav" style = "display:none">Game</a></li>
					<li><a href="#" id = "history_nav" style = "display:none">History</a></li>
					<li><a href="#" id = "videos_nav" style = "display:none">Videos</a></li>
				</ul>
		</div>
	</nav>


	<!-- Modal Structure -->
	<div id="login_modal" class="modal">

		<div class="modal-content">
		
			<form id="login_form" autocomplete = "off">
				<div class="input-field">
					<input type="email" id="user_name" autocomplete="" required />
					<label for="user_name">User Name</label>
				</div>
				<div class="input-field">
					<input type="password" id="user_password" autocomplete="" required />
					<label for="user_password">Password</label>
				</div>
				
				<button class="btn yellow darken-2 z-depth-0">Login</button>
			</form>


		</div>
	</div>

	<div id="new_user_modal" class="modal">

		<div class="modal-content">
		
			<form id="new_user_form" autocomplete = "off">
				<div class="input-field">
					<input type="email" id="user_name" autocomplete="" required />
					<label for="user_name">User Name</label>
				</div>

				<div class="input-field">
					<input type="password" id="user_password" autocomplete="" required />
					<label for="user_password">Password</label>
				</div>

				<div class="input-field">
					<input type="password" id="user_password_c" autocomplete="" required />
					<label for="user_password_c">Password</label>
				</div>


			
				
				<button class="btn yellow darken-2 z-depth-0">Login</button>
			</form>


		</div>
	</div>






  	<!-- Compiled and minified JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>

    <script>


    	users = ["user1@user.com","user2@user.com","user3@user.com"]
    	passwords = ["u1","u2","u3"]

    	//stores current user and the index in the list
    	//we have to modify the login process now to store the current user and index. 
    	cuser = ""
    	cuserindex = -1


		
		const login_form = document.querySelector("#login_form")
		const new_user_form = document.querySelector("#new_user_form")

		const login_nav = document.getElementById("login_nav")
		const logout_nav = document.getElementById("logout_nav")
		const game_nav = document.getElementById("game_nav")
		const history_nav = document.getElementById("history_nav")
		const video_nav = document.getElementById("videos_nav")

		

		
		document.addEventListener('DOMContentLoaded', function() {
			//console.log("LOADED")

			options = {};


			var elems = document.querySelectorAll('.modal');
			var instances = M.Modal.init(elems, options);
		});
		

		new_user_form.addEventListener("submit", (e) => {


			email = new_user_form["user_name"]

			pw = new_user_form["user_password"]

			pwc = new_user_form["user_password_c"]

			console.log(email)

			console.log(pw)
			
			console.log(pwc)
			

			//LOGIC NEEDED
			//Step 1 (IF): Confirm passwords match

				//Step 2 (LOOP):
				// Loop through users to ensure that email is not already in list

			//STEP 3 (IF): 
			//	Add user to list if the user is valid or prompt user with appropriate 
			//	error message






			var instance = M.Modal.getInstance(singleModalElem); 
			instance.close(); 

		});

		login_form.addEventListener("submit", (e) => {

			e.preventDefault();

			//STEP 1: We want to access the fields in the modal
			email = login_form["user_name"].value //stores the inputted email
			password = login_form["user_password"].value //stores the inputted password

			// clear the fields.
			login_form["user_name"].value = ""
			login_form["user_password"].value = ""

			
			valid = false; //assume invalid credentials	


			//STEP 2: We want to check if it is a valid user name and password

			/*
			This loop looks different than python, but it is the same 
			idea, but much nicer to use.  This is because it does not 
			assume the count check and chnage  
			
			for (count; check; change)
			*/

			for (i = 0; i < users.length; i = i + 1) {

				if (users[i] === email && passwords[i] === password) {
					valid = true;
					cuser = email;
					cuserindex = i;
					break;
				}
				

				

			}


			//Step 3: 
			//	If valid - update page 
			//	If not valid - notify user.
			if (valid === true) {
				alert("YOUR IN");

				video_nav.style.display = "block"
				game_nav.style.display = "block"
				history_nav.style.display = "block"
				logout_nav.style.display = "block"


				login_nav.style.display = "none"





			}
			else {
				alert("Invalid Credentials")
			}
		
			var singleModalElem = document.querySelector('#login_modal');
			var instance = M.Modal.getInstance(singleModalElem); 
			instance.close(); 
		});


		//To have the system logout we need to bind a click event to the logout button and then 
		//reset the state of the nav bar. What we have not done in this project is store the
		//user information.  This could be userful later if you need to remember what the user is doing

		logout_nav.addEventListener("click",(e) => {

				video_nav.style.display = "none"
				game_nav.style.display = "none"
				history_nav.style.display = "none"
				logout_nav.style.display = "none"


				login_nav.style.display = "block"

				cuser = ""
				cuserindex = -1


			
		});

  

    </script>


  
</body>
</html>